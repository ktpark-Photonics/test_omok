# Omok Reinforcement Learning Trainer
이 저장소는 스트림릿(Streamlit) 기반의 UI를 제공하여 다수의 에이전트가 리그전(Self-Play League)으로 오목(Omok, Gomoku) 전략을 학습하고, 학습된 모델과 직접 대국할 수 있도록 돕습니다. 실시간 학습 지표 확인, 체크포인트 저장/불러오기 기능을 지원해 누구나 간편하게 강화학습 워크플로우를 체험할 수 있습니다.

## 주요 기능

- **리그 자기대국 학습**: 원하는 개수(짝수)의 정책 신경망이 라운드마다 짝을 바꿔 대결하고, 승패/무승부에 따라 보상을 받으며 공동으로 발전합니다.
- **실시간 멀티 보드 모니터링**: 동시에 진행되는 모든 경기(예: 16명 에이전트 → 8판)를 실시간 보드로 확인하고 최근 수·결과를 추적할 수 있습니다.
- **상세 지표 및 순위판**: 라운드별 상위 승률, 최근 승률, 누적 전적 등을 차트·테이블로 확인하며 리그 흐름을 파악할 수 있습니다.
- **체크포인트 관리**: 학습된 모든 에이전트와 순위 정보를 묶어서 저장/불러오기 할 수 있습니다.
- **에이전트 선택 대국**: 리그에서 원하는 에이전트를 골라 직접 흑/백을 선택해 대국할 수 있습니다.

## 설치 및 실행 방법

1. Python 3.9 이상 환경을 준비합니다.
2. 의존성을 설치합니다.

   ```bash
   pip install -r requirements.txt
   ```

3. 스트림릿 앱을 실행합니다.

   ```bash
   streamlit run app.py
   ```

4. 브라우저가 자동으로 열리지 않는 경우, 터미널에 표시되는 로컬 URL (예: `http://localhost:8501`) 을 브라우저에서 열어 접속합니다.

## 사용 방법

### 1. 학습 탭

- **바둑판 크기**, **에이전트 수(짝수)**, **라운드 수**, **학습률**, **탐험 비율** 등을 조정한 뒤 `학습 시작` 버튼을 누르면 리그 학습이 진행됩니다.
- 학습 중에는 각 경기의 보드 상황과 최신 수가 실시간으로 스트리밍되며, 라운드별 리그 순위·승률이 갱신됩니다.
### 2. 플레이 탭

- 학습이 끝난 뒤 또는 체크포인트를 불러온 후, `플레이` 탭에서 에이전트와 직접 오목을 둘 수 있습니다.
- 내 돌 색(흑/백)을 고르고, 리그 순위판에서 원하는 에이전트를 선택한 뒤 대국을 시작합니다.
- 보드의 빈 칸을 클릭하여 수를 두면 선택한 에이전트가 즉시 응수하며, 상위 순위표를 함께 확인할 수 있습니다.

### 3. 체크포인트 탭

- 현재 메모리에 올라와 있는 에이전트를 원하는 이름으로 저장할 수 있습니다.
- 저장된 체크포인트 목록에서 `이 체크포인트 불러오기` 버튼을 누르면 해당 상태가 즉시 복원됩니다.

## 프로젝트 구조

```
.
├── app.py                # Streamlit 애플리케이션 엔트리 포인트
├── omok/
│   ├── __init__.py
│   ├── agent.py          # 정책 신경망 및 학습 에이전트
│   ├── game.py           # 오목 게임 규칙 및 상태 관리
│   ├── training.py       # 리그 기반 자기대국 학습 루프
│   └── checkpoint.py     # 체크포인트 저장/불러오기 유틸리티
├── requirements.txt
└── README.md
```

## 참고 사항

- 기본 학습 알고리즘은 정책 그라디언트(REINFORCE) 기반으로 구현되어 있으며, 단순한 예제용 구조입니다. 하이퍼파라미터를 변경하거나 네트워크 구조를 확장하여 성능을 향상시킬 수 있습니다.
- 학습 탭에서 연산 장치를 직접 선택할 수 있어 GPU(예: RTX 5080)로 학습을 가속할 수 있습니다. CUDA 지원 PyTorch가 설치되어 있으면 자동으로 목록에 표시됩니다.
- 체크포인트 파일은 프로젝트 루트의 `checkpoints/` 폴더에 저장됩니다.

### GPU 사용 안내

- **CUDA 지원 PyTorch 설치**: NVIDIA GPU(RTX 50 시리즈 등)를 사용하려면 CUDA 빌드의 PyTorch를 설치해야 합니다. 예시:

  ```bash
  pip install torch --index-url https://download.pytorch.org/whl/cu121
  ```

  CUDA 버전은 로컬 환경에 설치된 드라이버와 일치해야 합니다. RTX 5080과 같은 최신 GPU도 CUDA 12.x 빌드와 호환됩니다.
- 앱의 학습 폼에서 `연산 장치`를 `CUDA 0 · <GPU 이름>`으로 선택하면 해당 GPU를 즉시 사용합니다. GPU가 감지되지 않으면 CPU만 표시됩니다.
- 체크포인트를 불러올 때도 현재 선택한 장치로 가중치가 로드되며, GPU를 사용할 수 없으면 자동으로 CPU로 전환됩니다.

즐거운 실험 되세요! 🎮
